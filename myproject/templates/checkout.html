{% extends "base.html" %}

{% block title %}Checkout{% endblock %}

{% block content %}
<h1>Checkout</h1>

<!-- Order Summary -->
<div>
    <h2>Order Summary</h2>
    <table class="table">
        <thead>
            <tr>
                <th>Product</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Subtotal</th>
            </tr>
        </thead>
        <tbody>
            {% for item in cart_items %}
            <tr>
                <td>{{ item.product.name }}</td>
                <td>${{ item.product.price }}</td>
                <td>{{ item.quantity }}</td>
                <td>${{ item.product.price * item.quantity }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <p>Total: ${{ total_price }}</p>
</div>

<!-- Shipping Information Form -->
<h2>Shipping Information</h2>
<form id="shipping-form" action="{{ url_for('submit_shipping_info') }}" method="POST">
    <label for="name">Full name:</label>
    <input type="text" id="name" name="name" required><br><br>

    <label for="email">E-mail:</label>
    <input type="text" id="email" name="email" required><br><br>

    <label for="address">Address:</label>
    <input type="text" id="address" name="address" required><br><br>

    <label for="city">City:</label>
    <input type="text" id="city" name="city" required><br><br>

    <label for="state_province">State/Province:</label>
    <input type="text" id="state_province" name="state_province" required><br><br>

    <label for="zipcode">Zip Code:</label>
    <input type="text" id="zipcode" name="zipcode" required><br><br>

    <label for="country">Country:</label>
    <input type="text" id="country" name="country" required><br><br>

    <label for="phone">Phone Number:</label>
    <input type="text" id="phone" name="phone" required><br><br>

    <label for="date_of_birth">Date of Birth:</label>
    <input type="date" id="date_of_birth" name="date_of_birth" required><br><br>
</form>

<!-- Stripe Checkout Button -->
<script src="https://js.stripe.com/v3/"></script>
<button id="checkout-button">Pay Now</button>
<form action="{{ url_for('create_checkout_session', id=cart_id) }}" method="POST">
    <script
        src="https://checkout.stripe.com/checkout.js" class="stripe-button"
        data-key="pk_test_51OmEnSFkF5U5bz8eaLrTYiXJyJfHc14tZnMqjrJ4LS3KdlP0GATUYjZQsvssDImYx7oFJZ8C5Ez62ljHHRItpUOF00x9NvhzC7"
        data-amount="{{ total_price }}"
        data-name="Nomino Furniture"
        data-description="Purchase of Nomino Furniture"
        data-currency="usd"
        data-locale="auto"
        data-zip-code="false">
    </script>
{% endblock %}

